<template name="App_stats">
    <section class="overlay">
        <div id="statistics">

            <div class="z-depth-1 top-bar">            
                <h3 class="header center-align">
                    {{#if data.batch}}
                        Statistics of Batch {{ data.batch }}
                    {{else}}
                        Overall Statistics
                    {{/if}}
                </h3>
            </div>

            <!-- middle-bars -->
            {{#if isLoading}}
            <div class="z-depth-1 middle-bar">
                <div class="progress">
                    <div class="indeterminate"></div>
                </div>
                <div class="center-align">
                    Analyzing data. Please be patient.
                </div>
            </div>
            {{else}}
                {{> statistics data=getStats }}
            {{/if}}

            <!-- bottom0-bar -->
            <div class="z-depth-1 bottom-bar">
                All statistics were based on the <a href="http://www.beckscales.com" target="_blank">Beck's Scale</a>.
            </div>

        </div>
    </section>
</template>

<template name="statistics">
    <div class="z-depth-1 middle-bar">
        <table>
            <tr>
                <td class="first">Total Participation</td>
                <td>{{count data.session.total}}</td>
            </tr>
            <tr>
                <td class="first">Test Completed</td>
                <td>{{count data.session.completed}}</td>
            </tr>


            <tr>
                <td class="first" colspan="2">
                    Depression Results
                </td>
            </tr>
            <tr>
                <td>Having no depression</td>
                <td>{{count data.depression.[0].count}}</td>
            </tr>
           <tr>
                <td>Having mild mood disturbances</td>
                <td>{{count data.depression.[1].count}}</td>
            </tr>
            <tr>
                <td>Having borderline clinical depression</td>
                <td>{{count data.depression.[2].count}}</td>
            </tr>
            <tr>
                <td>Having moderate depression</td>
                <td>{{count data.depression.[3].count}}</td>
            </tr>
            <tr>
                <td>Suffering from severe depression</td>
                <td>{{count data.depression.[4].count}}</td>
            </tr>
            <tr>
                <td>Suffering from extreme depression</td>
                <td>{{count data.depression.[5].count}}</td>
            </tr>


            <tr>
                <td class="first" colspan="2">
                    Anxiety Results
                </td>
            </tr>
            <tr>
                <td>Having minimum level of anxiety</td>
                <td>{{count data.anxiety.[0].count}}</td>
            </tr>
            <tr>
                <td>Having mild anxiety</td>
                <td>{{count data.anxiety.[1].count}}</td>
            </tr>
            <tr>
                <td>Having moderate anxiety</td>
                <td>{{count data.anxiety.[2].count}}</td>
            </tr>
            <tr>
                <td>Suffering from severe anxiety</td>
                <td>{{count data.anxiety.[3].count}}</td>
            </tr>


            <tr>
                <td class="first" colspan="2">
                    Suicidal Tendency
                </td>
            </tr>
            <tr>
                <td>No significant suicidal tendency</td>
                <td>{{count data.suicide.[0].count}}</td>
            </tr>
            <tr>
                <td>At a significant risk for suicide</td>
                <td>{{count data.suicide.[1].count}}</td>
            </tr>


            <tr>
                <td class="first" colspan="2">
                    Hopelessness Resuts
                </td>
            </tr>
            <tr>
                <td>Not particularly hopeless</td>
                <td>{{count data.hopeless.[0].count}}</td>
            </tr>
            <tr>
                <td>Feeling very hopeless</td>
                <td>{{count data.hopeless.[1].count}}</td>
            </tr>
        </table> 
    </div>
    <canvas id="myChart" width="400" height="400"></canvas>
<script>
var ctx = document.getElementById("myChart").getContext('2d');
var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
        labels: ["Red", "Blue", "Yellow", "Green", "Purple", "Orange"],
        datasets: [{
            label: '# of Votes',
            data: [12, 19, 3, 5, 2, 3],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        }
    }
});
</script>
</template>

